# Best Practices

Требования:
1. Скорость сборки и получения релиза
2. Безопасность и контроль
3. Удобства и простоты

Рассмотрим наш пример
Мы берем образ debian, устанавливаем там nginx
Запустим сборку этого образа и смотрим, что образ у нас получился 203Мб

Один из способов оптимизации это уменьшать кол-во слоев в Dockerfile

1.Наши две команды можно записать в одну строку
На одни слой стало меньше
2. Каждый пакетный менеджер создает кеш, и мы можем очистить этот кэш, он нам не нужен, добавим 
   в эту команду удаление кеша

Запустим сборку этого образа и смотрим, что образ у нас получился 186Мб

3. Создадим файл dockerignore и пропишем там файлы, которые хотим исключить из нашего контейнера

Запустим сборку этого образа и смотрим его размер  178Мб

4. изменим исходный образ на alpine, его нам вполне достаточно, но при этом надо изменить тип 
   установщика, т.к. у него другой пакетный менеджер

Запустим сборку этого образа и смотрим его размер  7Мб

5. Лучше всегда указывать конеретную версию исходного образа, для nginx тоже желательно задать 
   версию, для чего используем переменные окружения, так запись будет красивей и короче 

6. У нас COPY идет вторым слоем, но особенность контейнера закключается в том, что если какой-то 
   слой изменился, то все последующие слои тоже будут менять, а исходные коды очень часто 
   будут менять, соотвественно и этот слой тоже, а соотвественно и все последующие слои, поэтому 
   желательно перенести после копирования конфига

> Копирование сходных кодов желательно всегда располагать в самом конце, т.к. он будет менять 
> постоянно

И желательно все что чаще меняется лучше располагать ближе к концу
 

